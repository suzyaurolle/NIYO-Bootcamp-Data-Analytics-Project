SELECT * FROM `final-bootcamp-project-380314.health_data.health_table` LIMIT 2939;
SELECT under_five_deaths AS children_death FROM `final-bootcamp-project-380314.health_data.health_table`;
SELECT DISTINCT country, BMI FROM `final-bootcamp-project-380314.health_data.health_table`
ORDER BY 2 desc;

SELECT DISTINCT country, life_expectancy FROM `final-bootcamp-project-380314.health_data.health_table`
ORDER BY 2 desc;
--Retrieve country where life expectancy is superioror equal to 85
SELECT * FROM `final-bootcamp-project-380314.health_data.health_table`
WHERE life_expectancy =85;
--Retrieve country where life expectancy is superior equal to 85
SELECT * FROM `final-bootcamp-project-380314.health_data.health_table`
WHERE life_expectancy >=85;
--Retrieve country where life expectancy is different to 85
SELECT * FROM `final-bootcamp-project-380314.health_data.health_table`
WHERE life_expectancy !=85;
--Retrieve country where life expectancy is greater than 80, BMI is less 25
SELECT * FROM `final-bootcamp-project-380314.health_data.health_table`
WHERE life_expectancy >80 AND BMI<25;
--Retrieve country where life expectancy is greater than 80, BMI is less than 25 and infant death not 1
SELECT * FROM `final-bootcamp-project-380314.health_data.health_table`
WHERE life_expectancy >80 AND BMI<25 AND infant_deaths !=1;
--Retrieve country where life expectancy is greater than 50, or adult mortality greater than 50 per 1000 population
SELECT * FROM `final-bootcamp-project-380314.health_data.health_table`
WHERE life_expectancy >50 OR adult_mortality >50;
--Retrieve country where life expectancy is greater than 60, or adult mortality less than 60 per 1000 population
SELECT * FROM `final-bootcamp-project-380314.health_data.health_table`
WHERE life_expectancy <60 OR adult_mortality <60;
--Retrieve country where status is not developed
SELECT country, status, FROM `final-bootcamp-project-380314.health_data.health_table`
WHERE NOT status = "Developed";
--Retrieve country where life expectancy is greater than 50, and BMI smaller than 25 and status is not developed
SELECT * FROM `final-bootcamp-project-380314.health_data.health_table`
WHERE life_expectancy >50 AND BMI<25 AND status != "Developed";
--60
SELECT * FROM `final-bootcamp-project-380314.health_data.health_table`
WHERE life_expectancy >60 AND BMI<25 AND status != "Developed";
--70
SELECT * FROM `final-bootcamp-project-380314.health_data.health_table`
WHERE life_expectancy >70 AND BMI<25 AND status != "Developed";
--80
SELECT * FROM `final-bootcamp-project-380314.health_data.health_table`
WHERE life_expectancy >80 AND BMI<25 AND status != "Developed";
--Retrieve the different life expectancy between 2000 and 2005
SELECT * FROM `final-bootcamp-project-380314.health_data.health_table`
WHERE C BETWEEN 2000 and 2005;
--Using ggregate functions in sql
--What is the total poplution of the data set
SELECT SUM(population)
 FROM `final-bootcamp-project-380314.health_data.sql_final2`
 WHERE year=2015;
 -- Select the average life expectancy in the data set
SELECT AVG(life_expectancy) 
 FROM `final-bootcamp-project-380314.health_data.sql_final2`
 WHERE year=2015;
 -- the average mortality rate of children under 5 in the data set
SELECT AVG(under_five_deaths) 
 FROM `final-bootcamp-project-380314.health_data.sql_final2`
 WHERE year=2015;
 --Retrieve all countries, BMI and life expectantancy values
 SELECT * FROM `final-bootcamp-project-380314.health_data.sql_final2`
 WHERE country LIKE "U%";
 --group by country
 --SELECT country,year, FROM `final-bootcamp-project-380314.health_data.sql_final2`
 --GROUP BY 2000
 --Check the null values in each column
 SELECT * FROM `final-bootcamp-project-380314.health_data.sql_final2`
 WHERE life_expectancy IS NULL;
-- IN EVERY COLUMN
SELECT * FROM `final-bootcamp-project-380314.health_data.sql_final2`
 WHERE country IS NULL OR life_expectancy IS NULL OR adult_mortality IS NULL OR under_five_deaths IS NULL OR BMI IS NULL OR infant_deaths IS NULL OR GDP IS NULL OR population IS NULL;
 --Retrieve the column where there is no null value
 SELECT * FROM `final-bootcamp-project-380314.health_data.sql_final2`
 WHERE country IS NOT NULL AND life_expectancy IS NOT NULL AND adult_mortality IS NOT NULL AND under_five_deaths IS NOT NULL AND BMI IS NOT NULL AND infant_deaths IS NOT NULL AND GDP IS NOT NULL AND population IS NOT NULL AND income_composition_of_resources IS NOT NULL AND alcohol IS NOT NULL AND percentage_expenditure IS NOT NULL AND hepatitis_B IS NOT NULL AND measles IS NOT NULL AND polio IS NOT NULL AND total_expenditure IS NOT NULL AND diphtheria IS NOT NULL AND HIV_AIDS IS NOT NULL AND thinness_1_to_19_years IS NOT NULL AND thinness_5_to_9_years IS NOT NULL AND total_expenditure_22 IS NOT NULL;
 -- find the total death of children and then the proportion of infants in it
 SELECT *, infant_deaths+under_five_deaths AS children_death
  FROM `health_data.sql_cleaned`
  WHERE infant_deaths+under_five_deaths IS NOT NULL;
  -- Find the children total immunisation rate
   SELECT *, ROUND((polio+diphtheria+hepatitis_B)/3, 2)AS  children_immunisation, ROUND((HIV_AIDS+under_five_deaths)/2, 2) AS children_deaths
  FROM `health_data.sql_cleaned`
  WHERE polio+diphtheria+hepatitis_B IS NOT NULL OR HIV_AIDS+under_five_deaths IS NOT NULL;
--subquery
SELECT * 
FROM `health_data.sql_cleaned`
WHERE BMI = 45;
--find the children death accross all contry in 2015

SELECT *, ROUND(children_deaths+under_five_deaths, 2) AS total_children_death
  FROM `health_data.sql_cleaned`
  WHERE infant_deaths+under_five_deaths IS NOT NULL AND year = 2015;
--join
--window
--count all countries from cleaneddata = 132
SELECT COUNT (DISTINCT country) AS Unique_Countries FROM `health_data.sql_cleaned`;
--count all country after cleaning = 192
SELECT COUNT (DISTINCT country) AS Unique_Countries FROM `health_data.sql_final2`;
--SELECT COUNT (DISTINCT country) AS Unique_Countries FROM `health_data.sql_cleaned`
SELECT country, AVG(population) AS mean_population
  FROM `health_data.sql_final2`
  GROUP BY country
